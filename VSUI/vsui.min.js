"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}document.addEventListener("touchstart",function(){},false);$(document).ready(function(){$(".vsui-header").width($(window).width()-24);$(".vsui-content").width($(window).width()-24);$(".vsui-footer").width($(window).width()-24);$(".vsui-picker").width($(window).width()-24);$(".vsui-radio input[type='radio']").on("click",function(){$(".vsui-radio").each(function(){$(this).removeClass("checked")});$(".vsui-radio-input").removeClass("checked");$(".vsui-radio input:checked").each(function(){$(this).parent("label").addClass("checked")})});$(".vsui-radio-input input[type='text']").on("click",function(){$(".vsui-radio").each(function(){$(this).removeClass("checked")});$(".vsui-radio-input").addClass("checked")});$("form.vsui-radioPage").submit(function(e){e.preventDefault();var action=$(this).attr("action")?"action='"+$(this).attr("action")+"'":"";var method=$(this).attr("method")?"method='"+$(this).attr("method")+"'":"";var formName=$(this).attr("name")?"name='"+$(this).attr("name")+"'":"";var input=$(this).children(".checked").children("input");var name=input.attr("name")?"name='"+input.attr("name")+"'":"";var value=$.trim(input.val());if(value.length<1){return false}var newId=generateMixed(8);var html="<form id='"+newId+"' "+action+" "+method+" "+formName+" style='display:none'>";html+="<input type=hidden "+name+" value='"+value+"'/>";html+="</form>";$(this).after(html);$("#"+newId).submit()});$("input[type='text']").on("focus",function(){var target=this;setTimeout(function(){target.scrollIntoViewIfNeeded()},200)});function generateMixed(n){var chars=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];var res="";for(var i=0;i<n;i++){var id=Math.ceil(Math.random()*15);res+=chars[id]}return res}function setBG(){}});function VsuiPicker(){var options=arguments[arguments.length-1];var defaults=$.extend({tapName1:"按钮选择器",tapName2:"时间选择器",btnName1:"按钮1",btnName2:"按钮2",btnName3:"按钮3",btnData1:"data1",btnData2:"data2",btnData3:"data3",onChoose:$.noop,onConfirm:$.noop},options);$(".vsui-content").css("padding-top",function(){var padding=parseInt($(".vsui-content").css("padding-top"))+26;return padding+"px"});var pickerHtml='<div class="vsui-picker"><div class="vsui-btnPicker" id="vsui-choose" style="display: none"><a href="javascript:;" class="vsui-btn vsui-btn_blue vsui-choose-btn" data-btn-data="'+defaults.btnData1+'">'+defaults.btnName1+'</a><a href="javascript:;" class="vsui-btn vsui-btn_blue vsui-choose-btn" data-btn-data="'+defaults.btnData2+'">'+defaults.btnName2+'</a><a href="javascript:;" class="vsui-btn vsui-btn_blue vsui-choose-btn" data-btn-data="'+defaults.btnData3+'">'+defaults.btnName3+'</a></div><div class="vsui-btnPicker" id="vsui-date" style="display: none"><a href="javascript:;" class="vsui-btn vsui-btn_blue vsui-date-btn" data-date-data="week">七天</a><a href="javascript:;" class="vsui-btn vsui-btn_blue vsui-date-btn" data-date-data="month">三十天</a><a href="javascript:;" class="vsui-btn vsui-btn_blue vsui-date-btn" data-date-data="all">全部</a></div><div class="vsui-datePicker" style="display: none"><div class="vsui-picker__hd">自定义时间</div><div class="vsui-picker__bd"><div class="vsui-picker__middle">至</div></div><div class="vsui-picker__fd"><a href="javascript:;" data-action="select" id="vsui-picker-confirm" class="vsui-btn vsui-btn_blue vsui-picker__action">确定</a></div></div><div class="vsui-picker-tapGroup"><div class="vsui-picker-tap" id="vsTap1">'+defaults.tapName1+'</div><div class="vsui-picker-tap" id="vsTap2">'+defaults.tapName2+'</div></div></div><div class="vsui-mask content"></div>';$(".vsui-header").after(pickerHtml);var startDate=new datePicker({start:"1989-01-06",end:2020,property:"start"});var endDate=new datePicker({start:"1993-03-21",end:2020,property:"end"});var vsTap1=false,vsTap2=false;$(".vsui-picker-tap").on("click",function(){switch($(this).attr("id")){case"vsTap1":if(vsTap1){if(vsTap2){}else{$("#vsTap2").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").removeClass("vsui-animate-fade-in").addClass("vsui-animate-fade-out");setTimeout(function(){$(".vsui-mask.content").hide();$("#vsui-choose").hide()},600)}vsTap1=false}else{if(vsTap2){$(".vsui-picker__mask").hide();$("#vsTap1").removeClass("active");$("#vsTap2").addClass("active");$("#vsui-choose").show();$(".vsui-picker").height(84);$("#vsui-date").fadeOut();setTimeout(function(){$(".vsui-datePicker").hide()},600);vsTap2=false}else{$("#vsui-choose").show();$("#vsTap2").addClass("active");$(".vsui-picker").height(84);$(".vsui-mask.content").show().removeClass("vsui-animate-fade-out").addClass("vsui-animate-fade-in")}vsTap1=true}break;case"vsTap2":if(vsTap1){if(vsTap2){}else{$(".vsui-datePicker").show();$("#vsTap1").addClass("active");$("#vsTap2").removeClass("active");$(".vsui-picker").height(307);$("#vsui-date").fadeIn();setTimeout(function(){$(".vsui-picker__mask").show();$("#vsui-choose").hide()},600);vsTap1=false;vsTap2=true}}else{if(vsTap2){$(".vsui-picker__mask").hide();$("#vsTap1").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").removeClass("vsui-animate-fade-in").addClass("vsui-animate-fade-out");setTimeout(function(){$(".vsui-mask.content").hide();$("#vsui-date").hide();$(".vsui-datePicker").hide()},600);vsTap2=false}else{$("#vsui-date").show();$(".vsui-datePicker").show();$("#vsTap1").addClass("active");$(".vsui-picker").height(307);$(".vsui-mask.content").show().removeClass("vsui-animate-fade-out").addClass("vsui-animate-fade-in");setTimeout(function(){$(".vsui-picker__mask").show()},500);vsTap2=true}}break;default:}});$(".vsui-mask.content").on("click",function(){if(vsTap1){$("#vsTap2").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").removeClass("vsui-animate-fade-in").addClass("vsui-animate-fade-out");setTimeout(function(){$(".vsui-mask.content").hide();$("#vsui-choose").hide()},600);vsTap1=false}else if(vsTap2){$(".vsui-picker__mask").hide();$("#vsTap1").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").removeClass("vsui-animate-fade-in").addClass("vsui-animate-fade-out");setTimeout(function(){$(".vsui-mask.content").hide();$("#vsui-date").hide();$(".vsui-datePicker").hide()},600);vsTap2=false}});$(".vsui-choose-btn").on("click",function(){var result={label:$(this).html(),value:$(this).data("btn-data")};defaults.onChoose(new Result(result));$("#vsTap2").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").fadeOut();setTimeout(function(){$("#vsui-choose").hide()},600);vsTap1=false});$(".vsui-date-btn").on("click",function(){var now=new Date;var date=undefined,year=undefined,month=undefined,day=undefined,nowYear=undefined,nowMonth=undefined,nowDay=undefined,startDate=undefined,endDate=undefined;nowYear={label:now.getFullYear(),value:now.getFullYear()};nowMonth={label:now.getMonth()+1,value:now.getMonth()+1};nowDay={label:now.getDate(),value:now.getDate()};switch($(this).data("date-data")){case"week":date=new Date(now.getTime()-7*24*3600*1e3);year={label:date.getFullYear(),value:date.getFullYear()};month={label:date.getMonth()+1,value:date.getMonth()+1};day={label:date.getDate(),value:date.getDate()};startDate=[new Result(year),new Result(month),new Result(day)];endDate=[new Result(nowYear),new Result(nowMonth),new Result(nowDay)];break;case"month":date=new Date(now.getTime()-30*24*3600*1e3);year={label:date.getFullYear(),value:date.getFullYear()};month={label:date.getMonth()+1,value:date.getMonth()+1};day={label:date.getDate(),value:date.getDate()};startDate=[new Result(year),new Result(month),new Result(day)];endDate=[new Result(nowYear),new Result(nowMonth),new Result(nowDay)];break;default:var all={label:"all",value:0};startDate=[new Result(all),new Result(all),new Result(all)];endDate=[new Result(all),new Result(all),new Result(all)]}defaults.onConfirm(startDate,endDate);$(".vsui-picker__mask").hide();$("#vsTap1").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").removeClass("vsui-animate-fade-in").addClass("vsui-animate-fade-out");setTimeout(function(){$(".vsui-mask.content").hide();$("#vsui-date").hide();$(".vsui-datePicker").hide()},600);vsTap2=false});$(".vsui-picker__action").on("click",function(){defaults.onConfirm(startDate.result,endDate.result);$(".vsui-picker__mask").hide();$("#vsTap1").removeClass("active");$(".vsui-picker").height(26);$(".vsui-mask.content").removeClass("vsui-animate-fade-in").addClass("vsui-animate-fade-out");setTimeout(function(){$(".vsui-mask.content").hide();$("#vsui-date").hide();$(".vsui-datePicker").hide()},600);vsTap2=false})}function VsuiDialog(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];if(_sington)return _sington;options=$.extend({title:null,content:"",className:"",buttons:[{label:"确定",type:"primary",onClick:$.noop}]},options);var conHtml="";conHtml='<div class="'+options.className+'"><div class="vsui-mask fullScreen"></div><div class="vsui-dialog">';if(options.title){conHtml+='<strong class="vsui-dialog__title">'+options.title+"</strong>"}else{conHtml+='<strong class="vsui-dialog__title"></strong>'}conHtml+='<div class="vsui-dialog__content">'+options.content+"</div>";conHtml+='<div class="vsui-dialog__btnTeam">';for(var i=0;i<options.buttons.length;i++){conHtml+='<a href="javascript:;" class="vsui-dialog__btn vsui-dialog__btn_'+options.buttons[i]["type"]+'">'+options.buttons[i]["label"]+"</a>"}conHtml+="</div></div></div>";var $dialogWrap=$(render(conHtml,options));var $dialog=$dialogWrap.find(".vsui-dialog");var $mask=$dialogWrap.find(".vsui-mask");function _hide(callback){_hide=$.noop;$mask.addClass("vsui-animate-fade-out");$dialog.addClass("vsui-animate-fade-out").on("animationend webkitAnimationEnd",function(){$dialogWrap.remove();_sington=false;callback&&callback()})}function hide(callback){_hide(callback)}$("body").append($dialogWrap);$(".vsui-mask").show();$mask.show().addClass("vsui-animate-fade-in");$dialog.addClass("vsui-animate-fade-in");$dialogWrap.on("click",".vsui-dialog__btn",function(evt){var index=$(this).index();if(options.buttons[index].onClick){if(options.buttons[index].onClick.call(this,evt)!==false)hide()}else{hide()}});_sington=$dialogWrap[0];_sington.hide=hide;return _sington}function alert(content,yes,options){if(content===undefined)content="";if(yes===undefined)yes=$.noop;if(typeof yes==="object"){options=yes;yes=$.noop}options=$.extend({content:content,buttons:[{label:"确定",type:"primary",onClick:yes}]},options);return VsuiDialog(options)}function confirm(content,yes,no,options){if(content===undefined)content="";if(yes===undefined)yes=$.noop;if(no===undefined)no=$.noop;if(typeof yes==="object"){options=yes;yes=$.noop}else if(typeof no==="object"){options=no;no=$.noop}options=$.extend({content:content,buttons:[{label:"取消",type:"default",onClick:no},{label:"确定",type:"primary",onClick:yes}]},options);return VsuiDialog(options)}function VsuiPrompt(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];if(_sington)return _sington;options=$.extend({title:null,input:[{label:"标签",type:"checkbox",name:"label"},{label:"文本框",type:"text",name:"input"}],more:null,buttons:[{label:"取消",type:"cancel"},{label:"确定",type:"submit"}],className:"",onConfirm:$.noop},options);var conHtml="";var moreHtml="";conHtml='<div class="'+options.className+'">'+'<div class="vsui-mask fullScreen"></div>'+'<div class="vsui-prompt">';if(options.title){conHtml+='<strong class="vsui-prompt__hd">'+options.title+"</strong>"}else{conHtml+='<strong class="vsui-prompt__hd"></strong>'}conHtml+='<div class="vsui-prompt__bd">';for(var i=0;i<options.input.length;i++){if(options.input[i]["type"]==="checkbox"){conHtml+='<label class="vsui-input-checkbox inline" for="vsPromptId'+i+'"><input type="checkbox" name="'+options.input[i]["name"]+'" id="vsPromptId'+i+'" value="'+options.input[i]["value"]+'"><div class="vsui-icon" style="'+options.input[i]["style"]+'"></div><p style="'+options.input[i]["style"]+'">'+options.input[i]["label"]+"</p></label>"}else if(options.input[i]["type"]==="text"){conHtml+='<div class="vsui-input-text inline"><div class="name" style="'+options.input[i]["style"]+'">'+options.input[i]["label"]+'</div><input name="'+options.input[i]["name"]+'" type="text" style="'+options.input[i]["style"]+'"></div>'}}if(options.more){conHtml+='<div class="vsui-prompt-more">'+options.more["text"]+"</div>"}conHtml+='</div><div class="vsui-prompt__fd">';for(var i=0;i<options.buttons.length;i++){conHtml+='<a href="javascript:;" class="vsui-btn vsui-btn__'+options.buttons[i]["type"]+'">'+options.buttons[i]["label"]+"</a>"}conHtml+="</div></div>";var $promptWrap=$(render(conHtml,options));var $prompt=$promptWrap.find(".vsui-prompt");var $mask=$promptWrap.find(".vsui-mask");function _hide(callback){_hide=$.noop;$mask.addClass("vsui-animate-fade-out");$prompt.addClass("vsui-animate-fade-out").on("animationend webkitAnimationEnd",function(){$promptWrap.remove();_sington=false;callback&&callback()})}function hide(callback){_hide(callback)}$("body").append($promptWrap);$(".vsui-mask").show();$mask.show().addClass("vsui-animate-fade-in");$prompt.addClass("vsui-animate-fade-in");$(".vsui-btn__submit").on("click",function(){var result=[];$prompt.find(".vsui-input-checkbox").each(function(){if($(this).children("input").is(":checked")){result.push({label:$(this).children("p").html(),name:$(this).children("input").attr("name"),type:"checkbox",value:$(this).children("input").val()})}});$prompt.find(".vsui-input-text").each(function(){if($(this).children("input").val()!=""){result.push({label:$(this).children(".name").html(),name:$(this).children("input").attr("name"),type:"text",value:$(this).children("input").val()})}});if(result.length==0){result=null}options.onConfirm(result);hide()});$(".vsui-btn__cancel").on("click",function(){hide()});$(".vsui-prompt-more").on("click",function(){if(options.more["type"]==="checkbox"){var tempId=generateMixed(6);moreHtml='<label class="vsui-input-checkbox inline" for="vsPromptId'+tempId+'"><input type="checkbox" name="'+options.more["name"]+'" id="vsPromptId'+tempId+'"><div class="vsui-icon" style="'+options.more["style"]+'"></div><p style="'+options.more["style"]+'">'+options.more["label"]+"</p></label>"}else if(options.more["type"]==="text"){moreHtml='<div class="vsui-input-text inline"><div class="name" style="'+options.more["style"]+'">'+options.more["label"]+'</div><input name="'+options.more["name"]+'" type="text" style="'+options.more["style"]+'"></div>'}$(this).before(moreHtml);console.log(options.more)});_sington=$promptWrap[0];_sington.hide=hide;return _sington}function Result(item){this.label=item.label;this.value=item.value}Result.prototype.toString=function(){return this.value};Result.prototype.valueOf=function(){return this.value};var _sington=undefined;var temp={};function picker(){var options=arguments[arguments.length-1];var defaults=$.extend({id:"default",className:"",container:"body",onChange:$.noop,onConfirm:$.noop},options);var items=undefined;var isMulti=false;if(arguments.length>2){var i=0;items=[];while(i<arguments.length-1){items.push(arguments[i++])}isMulti=true}else{items=arguments[0]}temp[defaults.id]=temp[defaults.id]||[];var result=[];var lineTemp=temp[defaults.id];var $picker=$(render('<div class="vsui-picker__dateItem"></div>',defaults));var depth=options.depth||(isMulti?items.length:depthOf(items[0])),groups="";function show(){if(defaults.property=="start"){$(".vsui-picker__bd").prepend($picker)}else if(defaults.property=="end"){$(".vsui-picker__bd").append($picker)}}function _hide(callback){_hide=$.noop;$picker.remove();_sington=false;callback&&callback()}function hide(callback){_hide(callback)}function scroll(items,level){if(lineTemp[level]===undefined&&defaults.defaultValue&&defaults.defaultValue[level]!==undefined){var defaultVal=defaults.defaultValue[level];var index=0,len=items.length;for(;index<len;++index){if(defaultVal==items[index].value)break}if(index<len){lineTemp[level]=index}else{console.warn("Picker has not match defaultValue: "+defaultVal)}}$picker.find(".vsui-picker__group").eq(level).scroll({items:items,temp:lineTemp[level],onChange:function onChange(item,index){if(item){result[level]=new Result(item)}else{result[level]=null}lineTemp[level]=index;if(isMulti){defaults.onChange(result)}else{if(item.children&&item.children.length>0){$picker.find(".vsui-picker__group").eq(level+1).show();!isMulti&&scroll(item.children,level+1)}else{result.splice(level+1);defaults.onChange(result)}}},onConfirm:defaults.onConfirm})}groups='<div class="vsui-picker__group x4">            <div class="vsui-picker__mask"></div>        <div class="vsui-picker__indicator"></div>        <div class="vsui-picker__content"></div>        </div> <div class="vsui-picker__group x2">        <div class="vsui-picker__mask"></div>        <div class="vsui-picker__indicator"></div>        <div class="vsui-picker__content"></div>        </div>        <div class="vsui-picker__group x2">        <div class="vsui-picker__mask"></div>        <div class="vsui-picker__indicator"></div>        <div class="vsui-picker__content"></div>        </div>';$picker.html(groups);show();if(isMulti){items.forEach(function(item,index){scroll(item,index)})}else{scroll(items,0)}_sington=$picker[0];_sington.hide=hide;this.result=result}function datePicker(options){var defaults=$.extend({id:"datePicker",onChange:$.noop,onConfirm:$.noop,start:2e3,end:2030,property:"start",defaultValue:[(new Date).getFullYear(),(new Date).getMonth()+1,(new Date).getDate()],cron:"* * *"},options);if(typeof defaults.start==="number"){defaults.start=new Date(defaults.start+"-01-01")}else if(typeof defaults.start==="string"){defaults.start=new Date(defaults.start)}if(typeof defaults.end==="number"){defaults.end=new Date(defaults.end+"-12-31")}else if(typeof defaults.end==="string"){defaults.end=new Date(defaults.end)}var findBy=function findBy(array,key,value){for(var i=0,len=array.length;i<len;i++){var _obj=array[i];if(_obj[key]==value){return _obj}}};var date=[];var interval=parse(defaults.cron,defaults.start,defaults.end);var obj=undefined;do{obj=interval.next();var year=obj.value.getFullYear();var month=obj.value.getMonth()+1;var day=obj.value.getDate();var Y=findBy(date,"value",year);if(!Y){Y={label:year,value:year,children:[]};date.push(Y)}var M=findBy(Y.children,"value",month);if(!M){M={label:String(month).length==2?String(month):"0"+month,value:month,children:[]};Y.children.push(M)}M.children.push({label:String(day).length==2?String(day):"0"+day,value:day})}while(!obj.done);return new picker(date,defaults)}var setTransition=function setTransition($target,time){return $target.css({"-webkit-transition":"all "+time+"s",transition:"all "+time+"s"})};var setTranslate=function setTranslate($target,diff){return $target.css({"-webkit-transform":"translate3d(0, "+diff+"px, 0)",transform:"translate3d(0, "+diff+"px, 0)"})};var getDefaultIndex=function getDefaultIndex(items){var current=Math.floor(items.length/2);var count=0;while(!!items[current]&&items[current].disabled){current=++current%items.length;count++;if(count>items.length){throw new Error("No selectable item.")}}return current};var getDefaultTranslate=function getDefaultTranslate(offset,rowHeight,items){var currentIndex=getDefaultIndex(items);return(offset-currentIndex)*rowHeight};var getMax=function getMax(offset,rowHeight){return offset*rowHeight};var getMin=function getMin(offset,rowHeight,length){return-(rowHeight*(length-offset-1))};$.fn.scroll=function(options){var _this=this;var defaults=$.extend({items:[],scrollable:".vsui-picker__content",offset:1,rowHeight:34,onChange:$.noop,temp:null,bodyHeight:3*34},options);var items=defaults.items.map(function(item){return'<div class="vsui-picker__item'+(item.disabled?" vsui-picker__item_disabled":"")+'">'+item.label+"</div>"}).join("");var $this=$(this);$this.find(".vsui-picker__content").html(items);var $scrollable=$this.find(defaults.scrollable);var start=undefined;var end=undefined;var startTime=undefined;var translate=undefined;var points=[];var windowHeight=window.innerHeight;if(defaults.temp!==null&&defaults.temp<defaults.items.length){var index=defaults.temp;defaults.onChange.call(this,defaults.items[index],index);translate=(defaults.offset-index)*defaults.rowHeight}else{var index=getDefaultIndex(defaults.items);defaults.onChange.call(this,defaults.items[index],index);translate=getDefaultTranslate(defaults.offset,defaults.rowHeight,defaults.items)}setTranslate($scrollable,translate);var stop=function stop(diff){translate+=diff;translate=Math.round(translate/defaults.rowHeight)*defaults.rowHeight;var max=getMax(defaults.offset,defaults.rowHeight);var min=getMin(defaults.offset,defaults.rowHeight,defaults.items.length);if(translate>max){translate=max}if(translate<min){translate=min}var index=defaults.offset-translate/defaults.rowHeight;while(!!defaults.items[index]&&defaults.items[index].disabled){diff>0?++index:--index}translate=(defaults.offset-index)*defaults.rowHeight;setTransition($scrollable,.3);setTranslate($scrollable,translate);defaults.onChange.call(_this,defaults.items[index],index)};function _start(pageY){start=pageY;startTime=+new Date}function _move(pageY){end=pageY;var diff=end-start;setTransition($scrollable,0);setTranslate($scrollable,translate+diff);startTime=+new Date;points.push({time:startTime,y:end});if(points.length>40){points.shift()}}function _end(pageY){if(!start)return;var endTime=(new Date).getTime();var relativeY=windowHeight-defaults.bodyHeight/2;end=pageY;if(endTime-startTime>100){if(Math.abs(end-start)>10){stop(end-start)}else{stop(relativeY-end)}}else{if(Math.abs(end-start)>10){var endPos=points.length-1;var startPos=endPos;for(var i=endPos;i>0&&startTime-points[i].time<100;i--){startPos=i}if(startPos!==endPos){var ep=points[endPos];var sp=points[startPos];var t=ep.time-sp.time;var s=ep.y-sp.y;var v=s/t;var diff=v*150+(end-start);stop(diff)}else{stop(0)}}else{stop(relativeY-end)}}start=null}$scrollable=$this.offAll().on("touchstart",function(evt){_start(evt.changedTouches[0].pageY)}).on("touchmove",function(evt){_move(evt.changedTouches[0].pageY);evt.preventDefault()}).on("touchend",function(evt){_end(evt.changedTouches[0].pageY)}).find(defaults.scrollable);var isSupportTouch="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;if(!isSupportTouch){$this.on("mousedown",function(evt){_start(evt.pageY);evt.stopPropagation();evt.preventDefault()}).on("mousemove",function(evt){if(!start)return;_move(evt.pageY);evt.stopPropagation();evt.preventDefault()}).on("mouseup mouseleave",function(evt){_end(evt.pageY);evt.stopPropagation();evt.preventDefault()})}};var regex=/^(\d+)(?:-(\d+))?(?:\/(\d+))?$/g;var constraints=[[1,31],[1,12],[0,6]];var Schedule=function(){function Schedule(fields,start,end){_classCallCheck(this,Schedule);this._dates=fields[0];this._months=fields[1];this._days=fields[2];this._start=start;this._end=end;this._pointer=start}_createClass(Schedule,[{key:"_findNext",value:function _findNext(){var next=undefined;while(true){if(this._end.getTime()-this._pointer.getTime()<=0){throw new Error("out of range, end is "+this._end+", current is "+this._pointer)}var month=this._pointer.getMonth();var date=this._pointer.getDate();var day=this._pointer.getDay();if(this._months.indexOf(month+1)===-1){this._pointer.setMonth(month+1);this._pointer.setDate(1);continue}if(this._dates.indexOf(date)===-1){this._pointer.setDate(date+1);continue}if(this._days.indexOf(day)===-1){this._pointer.setDate(date+1);continue}next=new Date(this._pointer);break}return next}},{key:"next",value:function next(){var value=this._findNext();this._pointer.setDate(this._pointer.getDate()+1);return{value:value,done:!this.hasNext()}}},{key:"hasNext",value:function hasNext(){try{this._findNext();return true}catch(e){return false}}}]);return Schedule}();function parseField(field,constraints){var low=constraints[0];var high=constraints[1];var result=[];var pointer=undefined;field=field.replace(/\*/g,low+"-"+high);var fields=field.split(",");for(var i=0,len=fields.length;i<len;i++){var f=fields[i];if(f.match(regex)){f.replace(regex,function($0,lower,upper,step){step=parseInt(step)||1;lower=Math.min(Math.max(low,~~Math.abs(lower)),high);upper=upper?Math.min(high,~~Math.abs(upper)):lower;pointer=lower;do{result.push(pointer);pointer+=step}while(pointer<=upper)})}}return result}function parse(expr,start,end){var atoms=expr.replace(/^\s\s*|\s\s*$/g,"").split(/\s+/);var fields=[];atoms.forEach(function(atom,index){var constraint=constraints[index];fields.push(parseField(atom,constraint))});return new Schedule(fields,start,end)}var render=function render(tpl,data){var code="let p=[];with(this){p.push('"+tpl.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');";return new Function(code).apply(data)};var depthOf=function depthOf(object){var depth=1;if(object.children&&object.children[0]){depth=depthOf(object.children[0])+1}return depth};var getStyle=function getStyle(el,styleProp){var value=undefined,defaultView=(el.ownerDocument||document).defaultView;if(defaultView&&defaultView.getComputedStyle){styleProp=styleProp.replace(/([A-Z])/g,"-$1").toLowerCase();return defaultView.getComputedStyle(el,null).getPropertyValue(styleProp)}else if(el.currentStyle){styleProp=styleProp.replace(/\-(\w)/g,function(str,letter){return letter.toUpperCase()});value=el.currentStyle[styleProp];if(/^\d+(em|pt|%|ex)?$/i.test(value)){return function(value){var oldLeft=el.style.left,oldRsLeft=el.runtimeStyle.left;el.runtimeStyle.left=el.currentStyle.left;el.style.left=value||0;value=el.style.pixelLeft+"px";el.style.left=oldLeft;el.runtimeStyle.left=oldRsLeft;return value}(value)}return value}};$.fn.offAll=function(){return this};